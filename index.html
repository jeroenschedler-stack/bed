<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BED Hospitality — Self-Assessment (SAR)</title>
<meta name="theme-color" content="#1E90FF"/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet"/>
<style>
  :root{ --brand:#1E90FF; --border:#E5E7EB; --text:#111827; --sub:#374151; --header-h:72px; }
  *{box-sizing:border-box} html,body{margin:0;padding:0} body{font-family:Inter,system-ui,-apple-system,Arial,sans-serif;background:#F9FAFB;color:var(--text);padding-top:var(--header-h)}
  .sar-header{position:fixed;inset:0 0 auto 0;background:#fff;border-bottom:1px solid var(--border);height:var(--header-h);display:flex;align-items:center;padding:0 12px;z-index:10}
  .sar-logo{font-size:28px;font-weight:800;letter-spacing:.3px}
  .sar-wrap{max-width:560px;margin:16px auto;padding:0 16px 32px}
  .sar-card{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:0 1px 2px rgba(0,0,0,.04);padding:18px}
  .sar-title{font-size:22px;font-weight:800;margin:0 0 8px}
  .sar-sub{color:var(--sub);margin:0 0 12px}
  .sar-row{display:flex;gap:8px;flex-wrap:wrap}
  .sar-field{flex:1;display:flex;flex-direction:column;gap:6px}
  .sar-label{font-size:12px;color:#6B7280}
  .sar-input{height:42px;padding:8px 10px;border:1px solid #D1D5DB;border-radius:8px}
  .sar-hotels{display:flex;gap:6px;flex-wrap:wrap;margin:8px 0 12px}
  .sar-hotel{flex:1 1 18%;min-width:0;text-transform:uppercase;font-weight:600;padding:10px 0;border:1px solid #D1D5DB;border-radius:8px;background:#fff}
  .sar-hotel.selected{background:var(--brand);color:#fff;border-color:var(--brand)}
  .sar-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}
  .sar-btn{min-height:44px;min-width:120px;padding:10px 16px;border-radius:8px;border:1px solid #D1D5DB;background:#fff;font-weight:600;cursor:pointer}
  .sar-btn.primary{background:var(--brand);border-color:var(--brand);color:#fff}
  .sar-page{display:none} .sar-page.active{display:block}
  .q-list{display:flex;flex-direction:column;gap:14px}
  .q-item{padding:12px 0;border-top:1px solid var(--border)} .q-item:first-child{border-top:none}
  .q-title{font-size:15px;font-weight:600;line-height:1.35;margin-bottom:2px}
  .q-sub{font-size:15px;line-height:1.35;color:var(--sub);margin-bottom:8px}
  .q-scale{display:flex;gap:8px} .q-scale input{position:absolute;opacity:0} 
  .q-scale label{width:36px;height:36px;border-radius:50%;border:1px solid #D1D5DB;background:#fff;display:inline-flex;align-items:center;justify-content:center;font-weight:700;cursor:pointer}
  .q-scale input:checked + label{background:var(--brand);border-color:var(--brand);color:#fff}
  .scorebar{position:relative;height:48px;border:1px solid #E5E7EB;border-radius:8px;background:linear-gradient(90deg,#ef4444 0%,#f97316 20%,#facc15 40%,#a3e635 65%,#22c55e 100%)}
  .score-marker{position:absolute;top:50%;transform:translateY(-50%);width:8px;height:68px;background:#111827;border-radius:8px;left:0}
</style>
<script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>
<header class="sar-header"><div class="sar-logo">BED HOSPITALITY 2.0</div></header>
<main class="sar-wrap">
  <section class="sar-card">
    <div class="sar-page active" data-step="welcome">
      <h1 class="sar-title">SELF-ASSESSMENT REPORT (SAR)</h1>
      <p class="sar-sub">Fill your info and start the test.</p>
      <div class="sar-row">
        <label class="sar-field"><span class="sar-label">your nickname</span><input id="sarNick" class="sar-input" type="text"/></label>
        <label class="sar-field"><span class="sar-label">your email</span><input id="sarEmail" class="sar-input" type="email"/></label>
      </div>
      <div class="sar-hotels" role="group" aria-label="Choose your BED Hotel">
        <button class="sar-hotel" data-hotel="BCK">BCK</button>
        <button class="sar-hotel" data-hotel="BPS">BPS</button>
        <button class="sar-hotel" data-hotel="BNM">BNM</button>
        <button class="sar-hotel" data-hotel="BCG">BCG</button>
        <button class="sar-hotel" data-hotel="FLY">FLY</button>
        <button class="sar-hotel" data-hotel="BED">BED</button>
      </div>
      <div class="sar-actions">
        <button id="startBtn" class="sar-btn primary" disabled>start</button>
      </div>
    </div>

    <div class="sar-page" data-step="q1">
      <h2 class="sar-title">STATEMENTS PART 1</h2>
      <div id="q1List" class="q-list"></div>
      <div class="sar-actions">
        <button class="sar-btn" data-nav="back">Back</button>
        <button id="q1Next" class="sar-btn primary" disabled data-nav="goto" data-step="q2">Next</button>
      </div>
    </div>

    <div class="sar-page" data-step="q2">
      <h2 class="sar-title">STATEMENTS PART 2</h2>
      <div id="q2List" class="q-list"></div>
      <div class="sar-actions">
        <button class="sar-btn" data-nav="back">Back</button>
        <button id="q2Next" class="sar-btn primary" disabled data-nav="goto" data-step="score">Next</button>
      </div>
    </div>

    <div class="sar-page" data-step="score">
      <h2 class="sar-title">SELF-ASSESSMENT SCORE</h2>
      <div class="sar-sub" id="scoreNumber">YOUR SCORE IS 0%</div>
      <div class="scorebar"><span id="scoreMarker" class="score-marker"></span></div>
      <div class="sar-sub" id="scoreBandText">—</div>
      <div class="sar-actions">
        <button class="sar-btn" data-nav="back">Back</button>
        <button id="finishPDF" class="sar-btn">PDF</button>
      </div>
    </div>
  </section>
</main>

<!-- Embedded 35 questions (no fetch needed) -->
<script id="embeddedQuestions" type="application/json">
[
  {
    "id": "q1",
    "statement": "1.0",
    "subtext": "Statement",
    "weight": 1.0
  },
  {
    "id": "q2",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q3",
    "statement": "2.0",
    "subtext": "Statement",
    "weight": 1.0
  },
  {
    "id": "q4",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q5",
    "statement": "3.0",
    "subtext": "Statement",
    "weight": 0.5
  },
  {
    "id": "q6",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q7",
    "statement": "4.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q8",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q9",
    "statement": "5.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q10",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q11",
    "statement": "6.0",
    "subtext": "Statement",
    "weight": 1.0
  },
  {
    "id": "q12",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q13",
    "statement": "7.0",
    "subtext": "Statement",
    "weight": 0.5
  },
  {
    "id": "q14",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q15",
    "statement": "8.0",
    "subtext": "Statement",
    "weight": 1.5
  },
  {
    "id": "q16",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q17",
    "statement": "9.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q18",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q19",
    "statement": "10.0",
    "subtext": "Statement",
    "weight": 1.0
  },
  {
    "id": "q20",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q21",
    "statement": "11.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q22",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q23",
    "statement": "12.0",
    "subtext": "Statement",
    "weight": 0.5
  },
  {
    "id": "q24",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q25",
    "statement": "13.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q26",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q27",
    "statement": "14.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q28",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q29",
    "statement": "15.0",
    "subtext": "Statement",
    "weight": 2.0
  },
  {
    "id": "q30",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q31",
    "statement": "16.0",
    "subtext": "Statement",
    "weight": 0.5
  },
  {
    "id": "q32",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q33",
    "statement": "17.0",
    "subtext": "Statement",
    "weight": 1.5
  },
  {
    "id": "q34",
    "statement": "nan",
    "subtext": "Subtext",
    "weight": 1.0
  },
  {
    "id": "q35",
    "statement": "18.0",
    "subtext": "Statement",
    "weight": 2.0
  }
]
</script>

<script>
(function(){
  const STEPS = ["welcome","q1","q2","score"];
  const S = window.sarState = { step:"welcome", user:{nickname:"",email:"",hotel:""}, answers:{}, questions:[] };

  // read embedded questions
  try { S.questions = JSON.parse(document.getElementById('embeddedQuestions').textContent) || []; } catch(_) { S.questions = []; }

  function go(step){ S.step=step; document.querySelectorAll('.sar-page').forEach(p=>p.classList.toggle('active', p.dataset.step===step)); if(step==="q1") renderQ1(); if(step==="q2") renderQ2(); if(step==="score") renderScore(); }
  function back(){ const i=STEPS.indexOf(S.step); if(i>0) go(STEPS[i-1]); }

  document.body.addEventListener('click', (e)=>{ const b=e.target.closest('[data-nav]'); if(!b) return; const act=b.dataset.nav; if(act==='back') back(); else if(act==='goto'){ go(b.dataset.step); }});

  // welcome bindings
  const nick=document.getElementById('sarNick'); const email=document.getElementById('sarEmail'); const startBtn=document.getElementById('startBtn');
  document.querySelector('.sar-hotels').addEventListener('click', (e)=>{ const b=e.target.closest('.sar-hotel'); if(!b) return; document.querySelectorAll('.sar-hotel').forEach(x=>x.classList.remove('selected')); b.classList.add('selected'); S.user.hotel=b.dataset.hotel; validateWelcome(); });
  nick.addEventListener('input', ()=>{ S.user.nickname=nick.value.trim(); validateWelcome(); });
  email.addEventListener('input', ()=>{ S.user.email=email.value.trim(); validateWelcome(); });
  function validateWelcome(){ const mail=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S.user.email||""); startBtn.disabled = !(S.user.nickname && mail && S.user.hotel); }
  startBtn.addEventListener('click', ()=> go('q1'));

  function renderQuestionHTML(q){ const name=`rate_${q.id}`; let radios=''; for(let v=1; v<=5; v++){ const id=`${q.id}_${v}`; radios+=`<input type="radio" name="${name}" id="${id}" value="${v}"/><label for="${id}">${v}</label>`; } return `<div class="q-item" data-qid="${q.id}"><div class="q-title">${escapeHTML(q.statement)} </div><div class="q-sub">${escapeHTML(q.subtext||"")}</div><div class="q-scale">${radios}</div></div>`; }
  function escapeHTML(s){ return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

  function renderQ1(){ const slice=S.questions.slice(0,18); const mount=document.getElementById('q1List'); mount.innerHTML = slice.map(renderQuestionHTML).join(''); mount.onchange = onRating; slice.forEach(q=>{ const v=S.answers[q.id]; if(v){ const el=document.getElementById(`${q.id}_${v}`); if(el) el.checked=true; } }); validatePageCompleted(slice, document.getElementById('q1Next')); }
  function renderQ2(){ const slice=S.questions.slice(18,35); const mount=document.getElementById('q2List'); mount.innerHTML = slice.map(renderQuestionHTML).join(''); mount.onchange = onRating; slice.forEach(q=>{ const v=S.answers[q.id]; if(v){ const el=document.getElementById(`${q.id}_${v}`); if(el) el.checked=true; } }); validatePageCompleted(slice, document.getElementById('q2Next')); }
  function onRating(e){ const input=e.target.closest('input[type="radio"]'); if(!input) return; const wrap=input.closest('.q-item'); const qid=wrap && wrap.dataset.qid; const val=parseInt(input.value,10); if(qid && val>=1 && val<=5){ S.answers[qid]=val; const step=S.step; if(step==='q1') validatePageCompleted(S.questions.slice(0,18), document.getElementById('q1Next')); if(step==='q2') validatePageCompleted(S.questions.slice(18,35), document.getElementById('q2Next')); } }
  function validatePageCompleted(list, btn){ const all=list.every(q=>S.answers[q.id]); if(btn) btn.disabled=!all; }

  function scoreBand(p){ if(p>=80) return "Excellent! Inspire others.<br>Lead by example"; if(p>=60) return "Great hospitality!<br>Keep challenging yourself"; if(p>=40) return "Use self-development.<br>Practice makes you better"; return "You’re behind.<br>Ask your team for guidance"; }
  function renderScore(){ const qs=S.questions; let ws=0, wm=0; qs.forEach(q=>{ const w=(typeof q.weight==='number' && isFinite(q.weight))? q.weight : 1; const v=S.answers[q.id]||0; ws += v*w; wm += 5*w; }); const pct = wm ? Math.round((ws/wm)*100) : 0; document.getElementById('scoreNumber').textContent = "YOUR SCORE IS " + pct + "%"; const m=document.getElementById('scoreMarker'); m.style.left = 'calc(' + pct + '% - 4px)'; document.getElementById('scoreBandText').innerHTML = scoreBand(pct); }

  // PDF (weighted)
  document.getElementById('finishPDF').addEventListener('click', async ()=>{ const ok = await waitFor(()=>window.jspdf && window.jspdf.jsPDF, 2000); if(!ok) return alert("PDF failed to load."); const jsPDF = window.jspdf.jsPDF; const doc=new jsPDF({unit:"pt",format:"a4"}); const pageW=doc.internal.pageSize.getWidth(); const margin=42, lineH=16; let y=48; function line(t, b=false){ doc.setFont("helvetica", b?"bold":"normal"); doc.setFontSize(12); const lines=doc.splitTextToSize(String(t||""), pageW-2*margin); lines.forEach(L=>{ if(y>780){ doc.addPage(); y=48; } doc.text(L, margin, y); y+=lineH; }); } line("BED Self-Assessment — Completed Report", true); line("Generated: "+ new Date().toLocaleString()); y+=6; line("Participant", true); line("User: "+(S.user.nickname||"-")+" ("+(S.user.email||"-")+") — "+(S.user.hotel||"-")); y+=6; let ws=0, wm=0; S.questions.forEach(q=>{const w=(typeof q.weight==='number'&&isFinite(q.weight))?q.weight:1; const v=S.answers[q.id]||0; ws+=v*w; wm+=5*w;}); const pct = wm? Math.round((ws/wm)*100):0; line("Score", true); line(ws.toFixed(1)+" / "+wm.toFixed(1)+"  ("+pct+"%)"); y+=6; line("Note: Weighted scoring applied."); y+=6; S.questions.forEach((q,i)=>{ line((i+1)+". "+q.statement+" — "+(q.subtext||"")+"  | Answer: "+(S.answers[q.id]||"-")+"  | Weight: "+(q.weight||1)); }); const ts=new Date().toISOString().slice(0,19).replace(/[:T]/g,"-"); const nick=(S.user.nickname||"user").replace(/\s+/g,"_"); doc.save("BED_Assessment_"+nick+"_"+ts+".pdf"); });

  function waitFor(cond, timeout=1500, interval=50){ return new Promise(res=>{ const st=Date.now(); (function tick(){ if(cond()) return res(true); if(Date.now()-st>timeout) return res(false); setTimeout(tick, interval); })(); }); }
})();
</script>
</body>
</html>
